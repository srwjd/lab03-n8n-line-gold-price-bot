\documentclass[aspectratio=169,12pt]{beamer}

% ===================================================================
% Package ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢ (XeLaTeX)
% ===================================================================
\usepackage{fontspec}
\IfFontExistsTF{TH Sarabun New}{
    \setmainfont{TH Sarabun New}[Scale=1.3]
    \setsansfont{TH Sarabun New}[Scale=1.3]
    \setmonofont{TH Sarabun New}[Scale=1.1]
}{
    \setmainfont{Tahoma}[Scale=1.0]
    \setsansfont{Tahoma}[Scale=1.0]
    \setmonofont{Consolas}[Scale=0.9]
}
\XeTeXlinebreaklocale "th"
\XeTeXlinebreakskip = 0pt plus 1pt minus 1pt

% ===================================================================
% Basic Packages
% ===================================================================
\usepackage{booktabs}
\usepackage{array}
\usepackage{amsmath}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{tikz}
\usepackage{graphicx}
\usetikzlibrary{shapes.geometric, arrows.meta, positioning, fit}

% ===================================================================
% Code Listings Style
% ===================================================================
\lstdefinelanguage{json}{
    basicstyle=\ttfamily\footnotesize,
    stringstyle=\color{red},
    morestring=[b]",
    literate=
     *{:}{{{\color{spumagenta}:}}}{1}
      {,}{{{\color{spumagenta},}}}{1}
      {\{}{{{\color{spumagenta}\{}}}{1}
      {\}}{{{\color{spumagenta}\}}}}{1}
      {[}{{{\color{spumagenta}[}}}{1}
      {]}{{{\color{spumagenta}]}}}{1}
}

\lstdefinelanguage{JavaScript}{
    keywords={const, let, var, if, else, return, function, async, await},
    keywordstyle=\color{spumagenta}\bfseries,
    ndkeywords={Math, JSON, console, log},
    ndkeywordstyle=\color{spudarkpink},
    stringstyle=\color{red},
    commentstyle=\color{gray}\itshape,
    morestring=[b]',
    morestring=[b]",
    morestring=[b]`,
    morecomment=[l]{//}
}

\lstset{
    basicstyle=\ttfamily\footnotesize,
    breaklines=true,
    frame=single,
    framerule=0.5pt,
    rulecolor=\color{spumagenta},
    backgroundcolor=\color{gray!5},
    showstringspaces=false,
    columns=fullflexible,
    keepspaces=true,
    xleftmargin=3pt,
    xrightmargin=3pt,
    aboveskip=8pt,
    belowskip=5pt
}

% ===================================================================
% Theme Configuration
% ===================================================================
\usetheme{Madrid}
\usecolortheme{whale}
\setbeamertemplate{navigation symbols}{}
\setbeamertemplate{footline}[frame number]
\usefonttheme{professionalfonts}

% Colors - SPU Magenta/Pink Theme
\definecolor{spumagenta}{RGB}{198, 0, 126}
\definecolor{spupink}{RGB}{236, 0, 140}
\definecolor{spudarkpink}{RGB}{153, 0, 102}
\definecolor{lightpink}{RGB}{255, 230, 245}
\definecolor{lightgreen}{RGB}{230, 250, 230}
\definecolor{lightyellow}{RGB}{255, 255, 230}
\definecolor{lightblue}{RGB}{230, 245, 255}

\setbeamercolor{title}{fg=white,bg=spumagenta}
\setbeamercolor{frametitle}{fg=white,bg=spumagenta}
\setbeamercolor{structure}{fg=spumagenta}
\setbeamercolor{palette primary}{bg=spumagenta,fg=white}
\setbeamercolor{palette secondary}{bg=spudarkpink,fg=white}
\setbeamercolor{palette tertiary}{bg=spumagenta,fg=white}
\setbeamercolor{palette quaternary}{bg=spudarkpink,fg=white}
\setbeamercolor{block title}{bg=spumagenta,fg=white}
\setbeamercolor{block body}{bg=lightpink}

% ===================================================================
% Title Information
% ===================================================================
\title[Lab 03: LINE Gold Bot]{Lab 03: LINE Gold Price Bot}
\subtitle{Hands-on Workshop}
\author{‡∏ß‡∏¥‡∏ä‡∏≤ n8n Workflow Automation}
\institute{‡∏†‡∏≤‡∏Ñ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ó‡∏µ‡πà 2/2568}
\date{}

% ===================================================================
% Document Start
% ===================================================================
\begin{document}

% ===== SLIDE 1: TITLE =====
\begin{frame}
\titlepage
\end{frame}

% ===== SLIDE 2: LAB OVERVIEW =====
\begin{frame}{Lab Overview}

\begin{center}
\colorbox{lightpink}{\textcolor{spumagenta}{\textbf{\Large ‡∏™‡∏£‡πâ‡∏≤‡∏á LINE Bot ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ó‡∏≠‡∏á}}}
\end{center}

\vspace{0.5cm}
\begin{columns}
\column{0.5\textwidth}
\textbf{‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î:}
\begin{itemize}
    \item ‡πÄ‡∏ß‡∏•‡∏≤: 3 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á
    \item ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: 100 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô
    \item Tests: 10 ‡∏Ç‡πâ‡∏≠
\end{itemize}

\column{0.5\textwidth}
\textbf{‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°:}
\begin{itemize}
    \item LINE Account
    \item Docker Desktop
    \item Terminal/Command Prompt
\end{itemize}
\end{columns}

\end{frame}

% ===== SLIDE 3: GRADING =====
\begin{frame}{‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô}

\begin{table}
\scriptsize
\begin{tabular}{clc}
\toprule
\textbf{Test} & \textbf{‡∏ï‡∏£‡∏ß‡∏à‡∏≠‡∏∞‡πÑ‡∏£} & \textbf{‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô} \\
\midrule
1 & ‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå workflow.json & 10 \\
2 & ‡πÄ‡∏õ‡πá‡∏ô valid JSON & 10 \\
3 & ‡∏°‡∏µ Webhook Node & 10 \\
4 & Webhook ‡πÉ‡∏ä‡πâ POST method & 10 \\
5 & ‡∏°‡∏µ HTTP Request Node ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Gold API & 10 \\
6 & Gold API URL ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á & 10 \\
7 & ‡∏°‡∏µ Code Node & 10 \\
8 & ‡∏°‡∏µ HTTP Request Node ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö LINE Reply & 10 \\
9 & LINE Reply URL ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á & 10 \\
10 & ‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ó‡∏≠‡∏á & 10 \\
\midrule
& \textbf{‡∏£‡∏ß‡∏°} & \textbf{100} \\
\bottomrule
\end{tabular}
\end{table}

\end{frame}

% ===== SLIDE 4: WORKFLOW OVERVIEW =====
\begin{frame}{Workflow ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á}

\begin{center}
\begin{tikzpicture}[
    node distance=1cm,
    box/.style={rectangle, draw=spumagenta, fill=lightpink, minimum width=1.8cm, minimum height=0.8cm, text centered, rounded corners, font=\scriptsize},
    arrow/.style={->, >=Stealth, thick, spumagenta}
]

\node[box] (webhook) {1. Webhook};
\node[box, right=of webhook] (if) {2. IF};
\node[box, right=of if] (gold) {3. Gold API};
\node[box, right=of gold] (code) {4. Code};
\node[box, right=of code] (line) {5. LINE Reply};

\draw[arrow] (webhook) -- (if);
\draw[arrow] (if) -- (gold);
\draw[arrow] (gold) -- (code);
\draw[arrow] (code) -- (line);

\end{tikzpicture}
\end{center}

\vspace{0.5cm}
\textbf{5 Nodes:}
\begin{enumerate}
    \item \textbf{Webhook} - ‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å LINE
    \item \textbf{IF} - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á
    \item \textbf{HTTP Request} - ‡∏î‡∏∂‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ó‡∏≠‡∏á (GET)
    \item \textbf{Code} - ‡∏à‡∏±‡∏î‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
    \item \textbf{HTTP Request} - ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° LINE (POST)
\end{enumerate}

\end{frame}

% ===================================================================
% STEP 1: LINE CHANNEL
% ===================================================================
\section{Step 1: ‡∏™‡∏£‡πâ‡∏≤‡∏á LINE Channel}

% ===== SLIDE 5: LINE DEVELOPERS =====
\begin{frame}{Step 1.1: ‡πÄ‡∏Ç‡πâ‡∏≤ LINE Developers Console}

\begin{enumerate}
    \item ‡πÄ‡∏õ‡∏¥‡∏î Browser ‡πÑ‡∏õ‡∏ó‡∏µ‡πà: \texttt{https://developers.line.biz/console/}
    \item ‡∏Ñ‡∏•‡∏¥‡∏Å \textbf{Log in with LINE account}
    \item Login ‡∏î‡πâ‡∏ß‡∏¢ LINE Account
\end{enumerate}

\vspace{0.5cm}
\begin{center}
\colorbox{lightyellow}{\textcolor{black}{\small ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ Provider ‡πÉ‡∏´‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà}}
\end{center}

\end{frame}

% ===== SLIDE 6: CREATE CHANNEL =====
\begin{frame}{Step 1.2: ‡∏™‡∏£‡πâ‡∏≤‡∏á Messaging API Channel}

\textbf{‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô:}
\begin{enumerate}
    \item ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Provider (‡∏´‡∏£‡∏∑‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà)
    \item ‡∏Ñ‡∏•‡∏¥‡∏Å \textbf{Create a new channel}
    \item ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å \textbf{Messaging API}
    \item ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:
    \begin{itemize}
        \item Channel name: \texttt{Gold Price Bot}
        \item Channel description: \texttt{Bot ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ó‡∏≠‡∏á}
        \item Category: Finance
    \end{itemize}
    \item ‡∏ï‡∏¥‡πä‡∏Å‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö Terms
    \item ‡∏Ñ‡∏•‡∏¥‡∏Å \textbf{Create}
\end{enumerate}

\end{frame}

% ===== SLIDE 7: GET TOKEN =====
\begin{frame}{Step 1.3: Issue Channel Access Token}

\textbf{‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô:}
\begin{enumerate}
    \item ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà Channel ‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á
    \item ‡πÑ‡∏õ‡∏ó‡∏µ‡πà \textbf{Messaging API} tab
    \item ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏•‡∏á‡πÑ‡∏õ‡∏ó‡∏µ‡πà \textbf{Channel access token}
    \item ‡∏Ñ‡∏•‡∏¥‡∏Å \textbf{Issue}
    \item \textbf{‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å Token ‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ!}
\end{enumerate}

\vspace{0.5cm}
\begin{center}
\colorbox{lightpink}{\textcolor{spumagenta}{\textbf{‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç: ‡πÄ‡∏Å‡πá‡∏ö Token ‡πÑ‡∏ß‡πâ‡πÉ‡∏ä‡πâ‡πÉ‡∏ô n8n}}}
\end{center}

\end{frame}

% ===== SLIDE 8: DISABLE AUTO REPLY =====
\begin{frame}{Step 1.4: ‡∏õ‡∏¥‡∏î Auto-reply}

\textbf{‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô:}
\begin{enumerate}
    \item ‡πÉ‡∏ô‡∏™‡πà‡∏ß‡∏ô \textbf{LINE Official Account features}
    \item ‡∏Ñ‡∏•‡∏¥‡∏Å \textbf{Edit} ‡∏ó‡∏µ‡πà Auto-reply messages
    \item ‡∏à‡∏∞‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤ LINE Official Account Manager
    \item ‡πÑ‡∏õ‡∏ó‡∏µ‡πà \textbf{‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö} > \textbf{‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥}
    \item \textbf{‡∏õ‡∏¥‡∏î} ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
    \item \textbf{‡∏õ‡∏¥‡∏î} ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏±‡∏Å‡∏ó‡∏≤‡∏¢
\end{enumerate}

\vspace{0.3cm}
\colorbox{lightyellow}{\textcolor{black}{\small ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏õ‡∏¥‡∏î Bot ‡∏à‡∏∞‡∏ï‡∏≠‡∏ö‡∏ã‡πâ‡∏≥‡∏Å‡∏±‡∏ö Auto-reply}}

\end{frame}

% ===================================================================
% STEP 2: NGROK
% ===================================================================
\section{Step 2: ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á ngrok}

% ===== SLIDE 9: NGROK SIGNUP =====
\begin{frame}{Step 2.1: ‡∏™‡∏°‡∏±‡∏Ñ‡∏£ ngrok}

\textbf{‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô:}
\begin{enumerate}
    \item ‡πÑ‡∏õ‡∏ó‡∏µ‡πà \texttt{https://ngrok.com}
    \item ‡∏Ñ‡∏•‡∏¥‡∏Å \textbf{Sign up for free}
    \item ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏î‡πâ‡∏ß‡∏¢ Email ‡∏´‡∏£‡∏∑‡∏≠ GitHub/Google
    \item ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô Email
    \item Login ‡πÄ‡∏Ç‡πâ‡∏≤ Dashboard
    \item ‡πÑ‡∏õ‡∏ó‡∏µ‡πà \textbf{Your Authtoken}
    \item ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å Authtoken
\end{enumerate}

\end{frame}

% ===== SLIDE 10: NGROK INSTALL =====
\begin{frame}[fragile]{Step 2.2: ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á ngrok}

\textbf{Windows (Chocolatey):}
\begin{lstlisting}[language=bash]
choco install ngrok
\end{lstlisting}

\textbf{macOS (Homebrew):}
\begin{lstlisting}[language=bash]
brew install ngrok
\end{lstlisting}

\textbf{‡∏´‡∏£‡∏∑‡∏≠ Download:}
\begin{itemize}
    \item ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏à‡∏≤‡∏Å \texttt{https://ngrok.com/download}
    \item ‡πÅ‡∏ï‡∏Å‡πÑ‡∏ü‡∏•‡πå zip
    \item ‡πÄ‡∏û‡∏¥‡πà‡∏° path ‡πÉ‡∏ô Environment Variables
\end{itemize}

\end{frame}

% ===== SLIDE 11: NGROK CONFIG =====
\begin{frame}[fragile]{Step 2.3: ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ ngrok}

\textbf{‡πÄ‡∏û‡∏¥‡πà‡∏° Authtoken:}
\begin{lstlisting}[language=bash]
ngrok config add-authtoken YOUR_AUTHTOKEN_HERE
\end{lstlisting}

\vspace{0.5cm}
\textbf{‡∏ó‡∏î‡∏™‡∏≠‡∏ö:}
\begin{lstlisting}[language=bash]
ngrok version
\end{lstlisting}

\vspace{0.3cm}
‡∏ñ‡πâ‡∏≤‡πÄ‡∏´‡πá‡∏ô version number = ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‚úÖ

\end{frame}

% ===================================================================
% STEP 3: RUN N8N + NGROK
% ===================================================================
\section{Step 3: ‡∏£‡∏±‡∏ô n8n + ngrok}

% ===== SLIDE 12: RUN N8N =====
\begin{frame}[fragile]{Step 3.1: ‡∏£‡∏±‡∏ô n8n}

\textbf{Terminal 1 - ‡∏£‡∏±‡∏ô n8n:}
\begin{lstlisting}[language=bash]
docker run -it --rm --name n8n \
  -p 5678:5678 \
  -e N8N_SECURE_COOKIE=false \
  n8nio/n8n
\end{lstlisting}

\vspace{0.5cm}
\textbf{‡πÄ‡∏õ‡∏¥‡∏î Browser:}
\begin{lstlisting}
http://localhost:5678
\end{lstlisting}

\end{frame}

% ===== SLIDE 13: RUN NGROK =====
\begin{frame}[fragile]{Step 3.2: ‡∏£‡∏±‡∏ô ngrok}

\textbf{Terminal 2 - ‡∏£‡∏±‡∏ô ngrok:}
\begin{lstlisting}[language=bash]
ngrok http 5678
\end{lstlisting}

\vspace{0.5cm}
\textbf{‡∏à‡∏î URL ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ:}
\begin{lstlisting}
Forwarding  https://abc123.ngrok-free.app -> localhost:5678
\end{lstlisting}

\vspace{0.3cm}
\begin{center}
\colorbox{lightpink}{\textcolor{spumagenta}{\textbf{‡∏à‡∏î URL ‡∏ô‡∏µ‡πâ‡πÑ‡∏ß‡πâ‡πÉ‡∏ä‡πâ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ LINE Webhook}}}
\end{center}

\end{frame}

% ===================================================================
% STEP 4: BUILD WORKFLOW
% ===================================================================
\section{Step 4: ‡∏™‡∏£‡πâ‡∏≤‡∏á Workflow}

% ===== SLIDE 14: CREATE WORKFLOW =====
\begin{frame}{Step 4.1: ‡∏™‡∏£‡πâ‡∏≤‡∏á Workflow ‡πÉ‡∏´‡∏°‡πà}

\textbf{‡πÉ‡∏ô n8n:}
\begin{enumerate}
    \item ‡∏Ñ‡∏•‡∏¥‡∏Å \textbf{+} ‡∏´‡∏£‡∏∑‡∏≠ \textbf{Add workflow}
    \item ‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠: \texttt{LINE Gold Price Bot}
\end{enumerate}

\vspace{0.5cm}
\textbf{Nodes ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°:}
\begin{enumerate}
    \item Webhook
    \item IF
    \item HTTP Request (Gold API)
    \item Code
    \item HTTP Request (LINE Reply)
\end{enumerate}

\end{frame}

% ===== SLIDE 15: WEBHOOK NODE =====
\begin{frame}[fragile]{Step 4.2: Webhook Node}

\textbf{Settings:}
\begin{itemize}
    \item \textbf{HTTP Method}: POST
    \item \textbf{Path}: \texttt{gold-bot}
\end{itemize}

\vspace{0.5cm}
\textbf{Webhook URL ‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô:}
\begin{lstlisting}
https://abc123.ngrok-free.app/webhook/gold-bot
\end{lstlisting}

\vspace{0.3cm}
\colorbox{lightyellow}{\textcolor{black}{\small ‡∏Ñ‡∏•‡∏¥‡∏Å "Listen for Test Event" ‡∏´‡∏£‡∏∑‡∏≠ "Test workflow" ‡πÑ‡∏ß‡πâ‡∏Å‡πà‡∏≠‡∏ô}}

\end{frame}

% ===== SLIDE 16: IF NODE =====
\begin{frame}[fragile]{Step 4.3: IF Node (‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á)}

\textbf{‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ message ‡∏°‡∏µ‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ "‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ó‡∏≠‡∏á" ‡∏´‡∏£‡∏∑‡∏≠ "gold" ‡∏´‡∏£‡∏∑‡∏≠ "‡∏ó‡∏≠‡∏á"}

\vspace{0.3cm}
\textbf{Conditions (OR):}
\begin{itemize}
    \item \texttt{\{\{ \$json.body.events[0].message.text \}\}} \textbf{contains} \texttt{‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ó‡∏≠‡∏á}
    \item \texttt{\{\{ \$json.body.events[0].message.text \}\}} \textbf{contains} \texttt{gold}
    \item \texttt{\{\{ \$json.body.events[0].message.text \}\}} \textbf{contains} \texttt{‡∏ó‡∏≠‡∏á}
\end{itemize}

\vspace{0.3cm}
\textbf{Combinator}: OR

\end{frame}

% ===== SLIDE 17: GOLD API NODE =====
\begin{frame}[fragile]{Step 4.4: HTTP Request Node (Gold API)}

\textbf{Settings:}
\begin{itemize}
    \item \textbf{Method}: GET
    \item \textbf{URL}: \texttt{https://api.chnwt.dev/thai-gold-api/latest}
\end{itemize}

\vspace{0.5cm}
\textbf{‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏≠‡∏∑‡πà‡∏ô} - API ‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á Authentication

\end{frame}

% ===== SLIDE 18: CODE NODE =====
\begin{frame}[fragile]{Step 4.5: Code Node}

\begin{lstlisting}[language=JavaScript, basicstyle=\ttfamily\scriptsize]
const goldData = $input.first().json;
const webhookData = $('Webhook').first().json;

const lineEvent = webhookData.body.events[0];
const response = goldData.response;

const message = `‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ó‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ
${response.update_date} ${response.update_time}

‡∏ó‡∏≠‡∏á‡∏Ñ‡∏≥‡πÅ‡∏ó‡πà‡∏á: ‡∏Ç‡∏≤‡∏¢ ${response.price.gold_bar.sell}
          ‡∏ã‡∏∑‡πâ‡∏≠ ${response.price.gold_bar.buy}

‡∏ó‡∏≠‡∏á‡∏£‡∏π‡∏õ‡∏û‡∏£‡∏£‡∏ì: ‡∏Ç‡∏≤‡∏¢ ${response.price.gold.sell}
           ‡∏ã‡∏∑‡πâ‡∏≠ ${response.price.gold.buy}`;

return [{
  json: {
    replyToken: lineEvent.replyToken,
    messages: [{ type: "text", text: message }]
  }
}];
\end{lstlisting}

\end{frame}

% ===== SLIDE 19: LINE REPLY NODE =====
\begin{frame}[fragile]{Step 4.6: HTTP Request Node (LINE Reply)}

\textbf{Settings:}
\begin{itemize}
    \item \textbf{Method}: POST
    \item \textbf{URL}: \texttt{https://api.line.me/v2/bot/message/reply}
    \item \textbf{Authentication}: Header Auth
    \item \textbf{Body}: JSON
\end{itemize}

\vspace{0.3cm}
\textbf{Header Auth:}
\begin{itemize}
    \item Name: \texttt{Authorization}
    \item Value: \texttt{Bearer YOUR\_CHANNEL\_ACCESS\_TOKEN}
\end{itemize}

\vspace{0.3cm}
\textbf{Body:} \texttt{\{\{ \$json \}\}}

\end{frame}

% ===== SLIDE 20: CONNECT NODES =====
\begin{frame}{Step 4.7: ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Nodes}

\textbf{‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠:}
\begin{enumerate}
    \item Webhook ‚Üí IF (main)
    \item IF (true) ‚Üí HTTP Request (Gold API)
    \item HTTP Request (Gold API) ‚Üí Code
    \item Code ‚Üí HTTP Request (LINE Reply)
\end{enumerate}

\vspace{0.5cm}
\begin{center}
\colorbox{lightgreen}{\textcolor{black}{\textbf{‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å Workflow!}}}
\end{center}

\end{frame}

% ===================================================================
% STEP 5: CONFIGURE LINE WEBHOOK
% ===================================================================
\section{Step 5: ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ LINE Webhook}

% ===== SLIDE 21: SET WEBHOOK URL =====
\begin{frame}[fragile]{Step 5.1: ‡πÉ‡∏™‡πà Webhook URL ‡πÉ‡∏ô LINE}

\textbf{‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô:}
\begin{enumerate}
    \item ‡πÑ‡∏õ‡∏ó‡∏µ‡πà LINE Developers Console
    \item ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Channel
    \item ‡πÑ‡∏õ‡∏ó‡∏µ‡πà \textbf{Messaging API} tab
    \item ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏õ‡∏ó‡∏µ‡πà \textbf{Webhook settings}
    \item ‡πÉ‡∏™‡πà URL:
\end{enumerate}

\begin{lstlisting}
https://YOUR-NGROK-URL.ngrok-free.app/webhook/gold-bot
\end{lstlisting}

\vspace{0.3cm}
\textbf{‡πÄ‡∏õ‡∏¥‡∏î} Use webhook = ON

\end{frame}

% ===== SLIDE 22: VERIFY WEBHOOK =====
\begin{frame}{Step 5.2: Verify Webhook}

\textbf{‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô:}
\begin{enumerate}
    \item ‡πÉ‡∏ô LINE Console ‡∏Ñ‡∏•‡∏¥‡∏Å \textbf{Verify}
    \item ‡∏ñ‡πâ‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô: \textcolor{green}{\textbf{Success}}
\end{enumerate}

\vspace{0.5cm}
\textbf{‡∏ñ‡πâ‡∏≤ Error:}
\begin{itemize}
    \item ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ n8n ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡∏π‡πà
    \item ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ ngrok ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡∏π‡πà
    \item ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö URL ‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
    \item ‡πÉ‡∏ô n8n ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏î Test workflow
\end{itemize}

\end{frame}

% ===================================================================
% STEP 6: TEST
% ===================================================================
\section{Step 6: ‡∏ó‡∏î‡∏™‡∏≠‡∏ö}

% ===== SLIDE 23: ADD FRIEND =====
\begin{frame}{Step 6.1: ‡πÄ‡∏û‡∏¥‡πà‡∏° Bot ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô}

\textbf{‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô:}
\begin{enumerate}
    \item ‡πÉ‡∏ô LINE Developers Console
    \item ‡πÑ‡∏õ‡∏ó‡∏µ‡πà \textbf{Messaging API} tab
    \item ‡∏™‡πÅ‡∏Å‡∏ô \textbf{QR Code} ‡∏î‡πâ‡∏ß‡∏¢ LINE App
    \item ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô
\end{enumerate}

\end{frame}

% ===== SLIDE 24: SEND MESSAGE =====
\begin{frame}{Step 6.2: ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°}

\textbf{‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô:}
\begin{enumerate}
    \item ‡πÄ‡∏õ‡∏¥‡∏î LINE App
    \item ‡πÄ‡∏õ‡∏¥‡∏î‡πÅ‡∏ä‡∏ó‡∏Å‡∏±‡∏ö Bot
    \item ‡∏û‡∏¥‡∏°‡∏û‡πå: \texttt{‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ó‡∏≠‡∏á}
    \item ‡∏£‡∏≠ Bot ‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö
\end{enumerate}

\vspace{0.5cm}
\textbf{Expected Result:}
\begin{itemize}
    \item Bot ‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ó‡∏≠‡∏á‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
    \item ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ó‡∏≠‡∏á‡∏Ñ‡∏≥‡πÅ‡∏ó‡πà‡∏á + ‡∏ó‡∏≠‡∏á‡∏£‡∏π‡∏õ‡∏û‡∏£‡∏£‡∏ì
\end{itemize}

\end{frame}

% ===================================================================
% STEP 7: EXPORT & SUBMIT
% ===================================================================
\section{Step 7: Export \& Submit}

% ===== SLIDE 25: EXPORT WORKFLOW =====
\begin{frame}[fragile]{Step 7.1: Export workflow.json}

\textbf{‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô:}
\begin{enumerate}
    \item ‡πÉ‡∏ô n8n ‡∏Ñ‡∏•‡∏¥‡∏Å Menu (‚ãÆ) ‡∏°‡∏∏‡∏°‡∏Ç‡∏ß‡∏≤‡∏ö‡∏ô
    \item ‡∏Ñ‡∏•‡∏¥‡∏Å \textbf{Download}
    \item ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏õ‡πá‡∏ô \texttt{workflow.json}
    \item ‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ô‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ
\end{enumerate}

\end{frame}

% ===== SLIDE 26: GIT PUSH =====
\begin{frame}[fragile]{Step 7.2: Push ‡∏Ç‡∏∂‡πâ‡∏ô GitHub}

\begin{lstlisting}[language=bash]
# ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏ü‡∏•‡πå
git add workflow.json

# Commit
git commit -m "Add LINE Gold Bot workflow"

# Push
git push origin main
\end{lstlisting}

\vspace{0.5cm}
\begin{center}
\colorbox{lightgreen}{\textcolor{black}{\textbf{‡∏£‡∏≠ Auto-grading ‡∏ï‡∏£‡∏ß‡∏à!}}}
\end{center}

\end{frame}

% ===== SLIDE 27: CHECKLIST =====
\begin{frame}{Checklist ‡∏Å‡πà‡∏≠‡∏ô‡∏™‡πà‡∏á}

\begin{itemize}
    \item[$\square$] ‡∏™‡∏£‡πâ‡∏≤‡∏á LINE Channel ‡πÅ‡∏•‡πâ‡∏ß
    \item[$\square$] ‡πÑ‡∏î‡πâ Channel Access Token ‡πÅ‡∏•‡πâ‡∏ß
    \item[$\square$] ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á ngrok ‡πÅ‡∏•‡πâ‡∏ß
    \item[$\square$] ‡∏£‡∏±‡∏ô n8n + ngrok ‡πÑ‡∏î‡πâ
    \item[$\square$] ‡∏™‡∏£‡πâ‡∏≤‡∏á Workflow ‡∏Ñ‡∏£‡∏ö 5 Nodes
    \item[$\square$] ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Webhook URL ‡πÉ‡∏ô LINE ‡πÅ‡∏•‡πâ‡∏ß
    \item[$\square$] ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏™‡πà‡∏á "‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ó‡∏≠‡∏á" ‡πÅ‡∏•‡πâ‡∏ß Bot ‡∏ï‡∏≠‡∏ö
    \item[$\square$] Export workflow.json ‡πÅ‡∏•‡πâ‡∏ß
    \item[$\square$] Push ‡∏Ç‡∏∂‡πâ‡∏ô GitHub ‡πÅ‡∏•‡πâ‡∏ß
\end{itemize}

\end{frame}

% ===== SLIDE 28: TROUBLESHOOTING =====
\begin{frame}{Troubleshooting}

\textbf{Bot ‡πÑ‡∏°‡πà‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö:}
\begin{itemize}
    \item ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ ngrok ‡∏¢‡∏±‡∏á‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡∏π‡πà
    \item ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Webhook URL ‡πÉ‡∏ô LINE Console
    \item ‡∏î‡∏π Execution log ‡πÉ‡∏ô n8n
\end{itemize}

\vspace{0.3cm}
\textbf{Error 401 Unauthorized:}
\begin{itemize}
    \item ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Channel Access Token
    \item ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Header: \texttt{Bearer YOUR\_TOKEN}
\end{itemize}

\vspace{0.3cm}
\textbf{ngrok URL ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô:}
\begin{itemize}
    \item ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó Webhook URL ‡πÉ‡∏ô LINE Console
    \item Verify ‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á
\end{itemize}

\end{frame}

% ===== SLIDE 29: Q&A =====
\begin{frame}{Q\&A}

\begin{center}
\Huge{‚ùì}

\vspace{1cm}
\textbf{\Large ‡∏°‡∏µ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÑ‡∏´‡∏°?}

\vspace{1cm}
\normalsize
‡∏î‡∏π README.md ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°

‡∏î‡∏π SETUP\_GUIDE.md ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
\end{center}

\end{frame}

% ===== SLIDE 30: GOOD LUCK =====
\begin{frame}

\begin{center}
\Huge{üçÄ}

\vspace{1cm}
\textbf{\Huge Good Luck!}

\vspace{1cm}
\Large{‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏ó‡∏≥ Lab ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!}
\end{center}

\end{frame}

\end{document}
