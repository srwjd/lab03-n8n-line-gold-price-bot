# ü§ñ Lab 03: n8n LINE Gold Price Bot

## üìã ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ

| ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ | ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î |
|--------|------------|
| **‡∏ß‡∏¥‡∏ä‡∏≤** | n8n Workflow Automation |
| **‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå** | 3 - LINE Messaging API & External API Integration |
| **‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏ï‡πá‡∏°** | 100 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô |
| **‡πÄ‡∏ß‡∏•‡∏≤** | 3 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á |
| **Prerequisite** | Lab 01, Lab 02 |

## üéØ ‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ

‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏ó‡∏≥ Lab ‡∏ô‡∏µ‡πâ‡πÄ‡∏™‡∏£‡πá‡∏à ‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏à‡∏∞‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ:

1. ‡∏™‡∏£‡πâ‡∏≤‡∏á LINE Messaging API Channel ‡πÑ‡∏î‡πâ
2. ‡πÉ‡∏ä‡πâ ngrok ‡∏™‡∏£‡πâ‡∏≤‡∏á HTTPS Tunnel ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Webhook ‡πÑ‡∏î‡πâ
3. ‡∏£‡∏±‡∏ö‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å LINE Webhook ‡πÑ‡∏î‡πâ
4. ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å External API ‡∏î‡πâ‡∏ß‡∏¢ HTTP Request Node ‡πÑ‡∏î‡πâ
5. ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡∏ú‡πà‡∏≤‡∏ô LINE Reply API ‡πÑ‡∏î‡πâ
6. ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Flow ‡πÅ‡∏ö‡∏ö‡∏°‡∏µ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç (IF Node) ‡πÑ‡∏î‡πâ

## üìù ‡πÇ‡∏à‡∏ó‡∏¢‡πå

‡∏™‡∏£‡πâ‡∏≤‡∏á **LINE Bot ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ó‡∏≠‡∏á** ‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:

1. ‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≤‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ú‡πà‡∏≤‡∏ô LINE
2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ñ‡∏≤‡∏°‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ó‡∏≠‡∏á‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà (`‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ó‡∏≠‡∏á`, `gold`, `‡∏ó‡∏≠‡∏á`)
3. ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å Thai Gold API ‡∏î‡∏∂‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ó‡∏≠‡∏á‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
4. ‡∏à‡∏±‡∏î‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏´‡πâ‡∏≠‡πà‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢
5. ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡∏ú‡πà‡∏≤‡∏ô LINE Reply API

## üåê API ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ

| API | URL | Method | Auth |
|-----|-----|--------|------|
| **Thai Gold API** | `https://api.chnwt.dev/thai-gold-api/latest` | GET | ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á |
| **LINE Reply API** | `https://api.line.me/v2/bot/message/reply` | POST | Bearer Token |

## üì• Thai Gold API Response

```json
{
  "status": "success",
  "response": {
    "update_date": "03/02/2569",
    "update_time": "‡πÄ‡∏ß‡∏•‡∏≤ 16:05 ‡∏ô. (‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà 58)",
    "price": {
      "gold": {
        "buy": "71,631.00",
        "sell": "74,100.00"
      },
      "gold_bar": {
        "buy": "73,100.00",
        "sell": "73,300.00"
      }
    }
  }
}
```

## üì§ Expected LINE Reply Message

```
üìä ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ó‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üìÖ 03/02/2569 ‡πÄ‡∏ß‡∏•‡∏≤ 16:05 ‡∏ô.

üèÜ ‡∏ó‡∏≠‡∏á‡∏Ñ‡∏≥‡πÅ‡∏ó‡πà‡∏á 96.5%
   üí∞ ‡∏Ç‡∏≤‡∏¢‡∏≠‡∏≠‡∏Å: 73,300.00 ‡∏ö‡∏≤‡∏ó
   üíµ ‡∏£‡∏±‡∏ö‡∏ã‡∏∑‡πâ‡∏≠: 73,100.00 ‡∏ö‡∏≤‡∏ó

üíç ‡∏ó‡∏≠‡∏á‡∏£‡∏π‡∏õ‡∏û‡∏£‡∏£‡∏ì 96.5%
   üí∞ ‡∏Ç‡∏≤‡∏¢‡∏≠‡∏≠‡∏Å: 74,100.00 ‡∏ö‡∏≤‡∏ó
   üíµ ‡∏£‡∏±‡∏ö‡∏ã‡∏∑‡πâ‡∏≠: 71,631.00 ‡∏ö‡∏≤‡∏ó

üìå ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏™‡∏°‡∏≤‡∏Ñ‡∏°‡∏Ñ‡πâ‡∏≤‡∏ó‡∏≠‡∏á‡∏Ñ‡∏≥
```

## üîß Workflow Architecture

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                              n8n Workflow                                        ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                                                  ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ Webhook  ‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ    IF    ‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ  HTTP    ‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ   Code   ‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ  HTTP    ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ (LINE)   ‚îÇ    ‚îÇ(‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á?)  ‚îÇ    ‚îÇ Request  ‚îÇ    ‚îÇ (Format) ‚îÇ    ‚îÇ Request  ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ          ‚îÇ    ‚îÇ          ‚îÇ    ‚îÇ(Gold API)‚îÇ    ‚îÇ          ‚îÇ    ‚îÇ(LINE API)‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ       ‚ñ≤                                                               ‚îÇ         ‚îÇ
‚îÇ       ‚îÇ                         ngrok tunnel                          ‚îÇ         ‚îÇ
‚îÇ       ‚îÇ         https://xxxx.ngrok-free.app/webhook/gold-bot          ‚îÇ         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
        ‚îÇ                                                               ‚îÇ
        ‚îÇ                    LINE Platform                              ‚îÇ
        ‚îÇ                                                               ‚ñº
   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                                                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
   ‚îÇ  User   ‚îÇ‚óÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ  User   ‚îÇ
   ‚îÇ (‡∏™‡πà‡∏á‡∏°‡∏≤) ‚îÇ                                                    ‚îÇ(‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö) ‚îÇ
   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                                                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## üîß ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥ Lab

### Step 1: ‡∏™‡∏£‡πâ‡∏≤‡∏á LINE Messaging API Channel

1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà [LINE Developers Console](https://developers.line.biz/console/)
2. Login ‡∏î‡πâ‡∏ß‡∏¢ LINE Account
3. ‡∏™‡∏£‡πâ‡∏≤‡∏á Provider ‡πÉ‡∏´‡∏°‡πà (‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ)
4. ‡∏™‡∏£‡πâ‡∏≤‡∏á Channel ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó **Messaging API**
5. ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Channel
6. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà **Messaging API** tab
7. Issue **Channel Access Token**
8. ‡∏õ‡∏¥‡∏î **Auto-reply messages** ‡πÅ‡∏•‡∏∞ **Greeting messages**

> üìñ ‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡∏ó‡∏µ‡πà [SETUP_GUIDE.md](SETUP_GUIDE.md)

### Step 2: ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏•‡∏∞‡∏£‡∏±‡∏ô ngrok

1. ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ó‡∏µ‡πà [ngrok.com](https://ngrok.com)
2. ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏•‡∏∞‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á ngrok
3. ‡πÄ‡∏û‡∏¥‡πà‡∏° authtoken:
```bash
ngrok config add-authtoken YOUR_AUTH_TOKEN
```
4. ‡∏£‡∏±‡∏ô ngrok:
```bash
ngrok http 5678
```
5. ‡∏à‡∏î URL ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ ‡πÄ‡∏ä‡πà‡∏ô `https://xxxx-xxx-xxx.ngrok-free.app`

### Step 3: ‡∏£‡∏±‡∏ô n8n

```bash
docker run -it --rm --name n8n -p 5678:5678 n8nio/n8n
```

### Step 4: ‡∏™‡∏£‡πâ‡∏≤‡∏á Workflow ‡πÉ‡∏ô n8n

#### 4.1 Webhook Node
- **HTTP Method**: POST
- **Path**: `gold-bot`
- **Response Mode**: Last Node

#### 4.2 IF Node (‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á)
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ message text ‡∏°‡∏µ‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ "‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ó‡∏≠‡∏á" ‡∏´‡∏£‡∏∑‡∏≠ "gold" ‡∏´‡∏£‡∏∑‡∏≠ "‡∏ó‡∏≠‡∏á"

#### 4.3 HTTP Request Node (Gold API)
- **Method**: GET
- **URL**: `https://api.chnwt.dev/thai-gold-api/latest`

#### 4.4 Code Node (‡∏à‡∏±‡∏î‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°)

```javascript
const goldData = $input.first().json;
const lineEvent = $('Webhook').first().json.body.events[0];

const response = goldData.response;
const message = `üìä ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ó‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üìÖ ${response.update_date} ${response.update_time}

üèÜ ‡∏ó‡∏≠‡∏á‡∏Ñ‡∏≥‡πÅ‡∏ó‡πà‡∏á 96.5%
   üí∞ ‡∏Ç‡∏≤‡∏¢‡∏≠‡∏≠‡∏Å: ${response.price.gold_bar.sell} ‡∏ö‡∏≤‡∏ó
   üíµ ‡∏£‡∏±‡∏ö‡∏ã‡∏∑‡πâ‡∏≠: ${response.price.gold_bar.buy} ‡∏ö‡∏≤‡∏ó

üíç ‡∏ó‡∏≠‡∏á‡∏£‡∏π‡∏õ‡∏û‡∏£‡∏£‡∏ì 96.5%
   üí∞ ‡∏Ç‡∏≤‡∏¢‡∏≠‡∏≠‡∏Å: ${response.price.gold.sell} ‡∏ö‡∏≤‡∏ó
   üíµ ‡∏£‡∏±‡∏ö‡∏ã‡∏∑‡πâ‡∏≠: ${response.price.gold.buy} ‡∏ö‡∏≤‡∏ó

üìå ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏™‡∏°‡∏≤‡∏Ñ‡∏°‡∏Ñ‡πâ‡∏≤‡∏ó‡∏≠‡∏á‡∏Ñ‡∏≥`;

return [{
  json: {
    replyToken: lineEvent.replyToken,
    messages: [{
      type: "text",
      text: message
    }]
  }
}];
```

#### 4.5 HTTP Request Node (LINE Reply API)
- **Method**: POST
- **URL**: `https://api.line.me/v2/bot/message/reply`
- **Authentication**: Header Auth
  - **Name**: `Authorization`
  - **Value**: `Bearer YOUR_CHANNEL_ACCESS_TOKEN`
- **Body Content Type**: JSON
- **Body**: `{{ $json }}`

### Step 5: ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ LINE Webhook URL

1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà LINE Developers Console
2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Channel ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
3. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà **Messaging API** tab
4. ‡πÉ‡∏™‡πà **Webhook URL**: `https://xxxx.ngrok-free.app/webhook/gold-bot`
5. ‡πÄ‡∏õ‡∏¥‡∏î **Use webhook**
6. ‡∏Ñ‡∏•‡∏¥‡∏Å **Verify** ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏î‡∏™‡∏≠‡∏ö

### Step 6: ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Bot

1. ‡πÄ‡∏û‡∏¥‡πà‡∏° Bot ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡πÉ‡∏ô LINE (‡∏™‡πÅ‡∏Å‡∏ô QR Code)
2. ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° `‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ó‡∏≠‡∏á`
3. Bot ‡∏Ñ‡∏ß‡∏£‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ó‡∏≠‡∏á‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î

### Step 7: Export ‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô

1. ‡πÉ‡∏ô n8n ‡∏Ñ‡∏•‡∏¥‡∏Å Menu (‚ãÆ) > **Download**
2. ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏õ‡πá‡∏ô `workflow.json`
3. ‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ô‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ
4. Commit ‡πÅ‡∏•‡∏∞ Push:
```bash
git add workflow.json
git commit -m "Add LINE Gold Bot workflow"
git push origin main
```

## ‚úÖ ‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô (100 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô)

| Test | ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô | ‡∏ï‡∏£‡∏ß‡∏à‡∏≠‡∏∞‡πÑ‡∏£ |
|------|-------|----------|
| ‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå workflow.json | 10 | ‡∏™‡πà‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏°‡∏≤ |
| ‡πÄ‡∏õ‡πá‡∏ô valid JSON | 10 | Parse ‡πÑ‡∏î‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á |
| ‡∏°‡∏µ Webhook Node | 10 | ‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å LINE |
| Webhook ‡πÉ‡∏ä‡πâ POST method | 10 | ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á |
| ‡∏°‡∏µ HTTP Request Node ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Gold API | 10 | ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å API ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ó‡∏≠‡∏á |
| Gold API URL ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á | 10 | `api.chnwt.dev/thai-gold-api/latest` |
| ‡∏°‡∏µ Code Node | 10 | ‡∏à‡∏±‡∏î‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° |
| ‡∏°‡∏µ HTTP Request Node ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö LINE Reply | 10 | ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏•‡∏±‡∏ö |
| LINE Reply URL ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á | 10 | `api.line.me/v2/bot/message/reply` |
| ‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ó‡∏≠‡∏á | 10 | ‡πÅ‡∏™‡∏î‡∏á buy/sell price |
| **‡∏£‡∏ß‡∏°** | **100** | |

## üìö Resources

- [LINE Messaging API Documentation](https://developers.line.biz/en/docs/messaging-api/)
- [ngrok Documentation](https://ngrok.com/docs)
- [Thai Gold API](https://github.com/max180643/thai-gold-api)
- [n8n HTTP Request Node](https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.httprequest/)

## ‚ö†Ô∏è ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏£‡∏£‡∏∞‡∏ß‡∏±‡∏á

1. **‡∏≠‡∏¢‡πà‡∏≤‡πÄ‡∏ú‡∏¢‡πÅ‡∏û‡∏£‡πà Channel Access Token** - ‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏±‡∏ö
2. **ngrok URL ‡∏à‡∏∞‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ô‡πÉ‡∏´‡∏°‡πà** - ‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó LINE Webhook URL
3. **‡∏≠‡∏¢‡πà‡∏≤‡∏õ‡∏¥‡∏î Terminal** ‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ô ngrok ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ó‡∏≥ Lab
4. **replyToken ‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß** - ‡πÉ‡∏ä‡πâ‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏î‡πâ‡πÅ‡∏Ñ‡πà 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á

## üÜò Troubleshooting

### Bot ‡πÑ‡∏°‡πà‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö
1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ ngrok ‡∏¢‡∏±‡∏á‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡∏π‡πà
2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Webhook URL ‡πÉ‡∏ô LINE Console
3. ‡∏î‡∏π Execution log ‡πÉ‡∏ô n8n

### Webhook Verify ‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô
1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö URL ‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (‡∏£‡∏ß‡∏° path `/webhook/gold-bot`)
2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ n8n Workflow ‡∏ñ‡∏π‡∏Å activate ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏î Test workflow

### Error 401 Unauthorized
1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Channel Access Token
2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Header Authorization format: `Bearer YOUR_TOKEN`

---

**Good luck! üçÄ**
